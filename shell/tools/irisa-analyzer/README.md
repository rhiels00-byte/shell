# 이리사 종합 분석기

> "그래서 그랬구나!" - 수업 산출물 종합 분석 도구

교사를 위한 AI 기반 수업 산출물 종합 분석 플랫폼입니다. 학생의 풀이 과정과 심리정서 검사를 종합 분석하여 상담과 생기부 작성에 활용할 수 있는 인사이트를 제공합니다.

## 이 제품으로 할 수 있는 것

### 하나의 분석 문서로 세 가지 목표 달성

이리사가 생성한 분석 결과 문서 하나로 다음의 모든 업무를 처리할 수 있습니다:

**1. 학생에 대한 깊은 이해**
- 학습 과정과 정서 상태를 통합적으로 파악
- 결과가 아닌 과정 중심의 인사이트 확보
- 학생의 강점과 성장 영역을 명확하게 이해

**2. 효과적인 상담 진행**
- 학생용: 눈높이에 맞춘 격려와 동기부여 멘트 제공
- 학부모용: 가정에서 실천 가능한 구체적 지원 방법 안내
- 팩트 기반 상담으로 신뢰도 향상

**3. 생활기록부 즉시 작성**
- 학습 코칭 의견과 정서 코칭 의견 자동 생성
- 생기부 작성 기준에 맞춘 문장 제공
- 30분 걸리던 작업을 5분 이내로 단축

> **목표**: 교사가 데이터 분석에 시간을 쓰는 대신, 학생과의 소통과 교육에 집중할 수 있도록 지원합니다.

## 주요 기능

### 1. 교사용 Fact 분석
- 매쓰캔버스 풀이 활동 미디어 분석
- 2022개정 교육과정 기준 평가
- 문제 이해도, 풀이 과정, 결과 평가
- 심화/강화 학습용 유사 문항 자동 생성

### 2. 학생/학부모용 분석
- 학습심리정서검사(SEL) 결과 분석
- 강점과 성장 영역 분석
- 실천 가능한 개선 방법 제시
- 학생/학부모 맞춤형 상담 멘트

### 3. 생기부 작성 가이드
- 학습 코칭 종합 의견
- 심리·정서 코칭 종합 의견
- 통합 소견

## 기술 스택

- **Frontend**: Next.js 15, React 19, TypeScript
- **Styling**: Tailwind CSS
- **AI**: OpenAI GPT-4o (Vision API)
- **Document**: docx, jsPDF
- **Deployment**: Vercel (권장)

## 시작하기

### 1. 프로젝트 클론 및 의존성 설치

```bash
cd irisa-analyzer
npm install
```

### 2. 환경 변수 설정

`.env` 파일을 생성하고 OpenAI API 키를 설정하세요:

```bash
cp .env.example .env
```

`.env` 파일을 열어 API 키를 입력:

```
OPENAI_API_KEY=your_openai_api_key_here
```

### 3. 개발 서버 실행

```bash
npm run dev
```

브라우저에서 [http://localhost:3000](http://localhost:3000)을 열어 확인하세요.

## 사용 방법

### 1. 학급 정보 입력
- 학교급 선택 (초등/중등)
- 학년 선택
- 과목: 수학 (고정)

### 2. 자료 업로드
다음 자료 중 최소 하나를 업로드:
- 매쓰캔버스 풀이 활동 미디어 (영상/이미지)
- 학습심리정서검사 결과지 1
- 학습심리정서검사 결과지 2

### 3. 분석 생성
"분석 생성" 버튼을 클릭하여 AI 분석 시작

### 4. 결과 확인
- 탭 1: 선생님용 Fact 분석
- 탭 2: 학생/학부모용 분석 + 생기부 가이드

### 5. 다운로드
- Word 또는 PDF 형식으로 다운로드
- 각 탭별로 개별 파일 생성

## 프로젝트 구조

```
irisa-analyzer/
├── app/
│   ├── api/
│   │   ├── analyze/      # AI 분석 엔드포인트
│   │   └── download/     # 파일 다운로드 엔드포인트
│   ├── components/
│   │   ├── InputForm.tsx      # 입력 폼 컴포넌트
│   │   └── ResultDisplay.tsx  # 결과 표시 컴포넌트
│   ├── globals.css
│   ├── layout.tsx
│   └── page.tsx          # 메인 페이지
├── lib/
│   └── prompts/          # AI 프롬프트 관리
│       ├── teacherAnalysis.ts   # 교사용 분석 프롬프트
│       ├── studentAnalysis.ts   # 학생용 분석 프롬프트
│       └── recordGuide.ts       # 생기부 가이드 프롬프트
├── public/
├── .env.example
├── package.json
└── README.md
```

## 바이브 코딩 원칙

이 프로젝트는 "바이브 코딩" 원칙을 따릅니다:

1. **프롬프트 중심**: AI 동작은 `lib/prompts/`에서 독립적으로 관리
2. **최소 UI**: 깔끔하고 직관적인 인터페이스
3. **설정 기반**: 하드코딩 대신 설정 파일로 제어
4. **모듈화**: 각 프롬프트는 독립적으로 교체 가능

## 프롬프트 커스터마이징

각 프롬프트는 독립적으로 수정 가능합니다:

- `lib/prompts/teacherAnalysis.ts` - 학습 과정 분석 로직
- `lib/prompts/studentAnalysis.ts` - SEL 분석 로직
- `lib/prompts/recordGuide.ts` - 생기부 작성 로직

프롬프트를 수정하면 AI의 분석 방식과 출력 형식이 즉시 변경됩니다.

## 배포

### Vercel 배포 (권장)

```bash
npm run build
vercel deploy
```

환경 변수 `OPENAI_API_KEY`를 Vercel 대시보드에서 설정하세요.

## 로드맵

### Step 1 (현재)
- ✅ 학생 1명 기준 분석
- ✅ 초등/중등 수학
- ✅ 핵심 산출물 생성

### Step 2 (계획)
- [ ] 학생 4명 동시 분석
- [ ] 프롬프트 버전 관리
- [ ] 교사 피드백 반영

### Step 3 (계획)
- [ ] 다과목 지원
- [ ] 플랫폼 통합
- [ ] 학사 시스템 연동

## 라이선스

Private - 교육 목적으로만 사용

## 문의

프로젝트 관련 문의사항이 있으시면 이슈를 등록해주세요.

## 전체 원칙 (이게 흔들리면 다 무너짐) ** 2026.02.01 추가

### 핵심 설계 원칙

이리사 종합 분석기는 다음의 단일 원칙을 기반으로 설계된다.

> **분석의 최소 단위는 항상 ‘학생 1명(Student Atomic Unit)’이다.**

- 파일이 몇 개이든
- 한 파일에 학생이 몇 명이든
- 자료 형식이 무엇이든  

**모든 분석은 반드시 학생 단위로 분해된 이후 수행된다.**

교사는 “자료를 업로드”만 하고,  
시스템이 “학생을 식별·정리”하며,  
AI는 “학생 1명만 분석”한다.

---

## Step 1 + Step 2를 동시에 만족하는 구조

이 프로젝트는 다음 두 사용 시나리오를 **동일한 구조**로 처리한다.

### Case 1. 학생 1명 분석
- 자료는 1개 또는 N개
- 자료 안에 다른 학생 내용이 포함되어 있어도 무관
- 시스템이 해당 학생의 자료만 추출하여 분석

### Case 2. 학생 N명 분석
- 자료는 1개 또는 N개
- 1개 파일에 1명 / 여러 명 혼재 가능
- 페이지 단위, 표 단위, 구간 단위로 학생별 분리

👉 **교사는 파일 구조를 신경 쓰지 않는다.**

---

## 프론트엔드 설계 원칙 (교사용 화면)

### 교사가 선택하는 것은 최소화한다

교사는 다음 항목만 선택한다.

- 분석 대상:  
  - ( ) 학생 1명  
  - ( ) 학생 여러 명
- 학생 기본 정보 (이름/순번/학년)
- 학습자 수준 (초등 / 중등 / 고등)

❌ 교사가 하지 않는 것
- 파일 유형 판단
- 파일 분리
- 학생별 파일 정리
- 규칙적인 파일명 작성

---

### 자료 업로드 UX 원칙

- 모든 파일은 **그냥 업로드 가능**
  - 영상 / PDF / 이미지 / 엑셀 혼합 가능
- 시스템이 자동으로 자료를 분석하여:
  - 페이지 단위
  - 시간 구간 단위
  - 표/행 단위
로 **학생 후보를 추출**한다.

---

### 자료–학생 매핑 확인 단계 (필수)

업로드 이후, 교사는 **확인·수정만** 한다.

예시:

- 파일 A
  - p.1~3 → 학생 A
  - p.4~6 → 학생 B
- 파일 B
  - 전체 → 학생 A

👉 이 단계에서 **교사는 “맞다 / 아니다”만 판단**한다.

---

## 백엔드 데이터 구조 원칙

### 1. Raw File (원본 보존)
- 업로드된 파일 원본 그대로 저장
- 수정 및 가공 금지

### 2. Extracted Unit (분해 단위)
- Raw File에서 추출된 최소 단위
- page range / time range / row range

### 3. Student Dataset (분석 단위)
- 학생 1명 기준으로 묶인 자료 집합
- 프롬프트에는 오직 이 데이터만 전달

```text
Student Dataset
 ├─ Extracted Unit 1
 ├─ Extracted Unit 2
 └─ Extracted Unit N

## 프론트 입력 플로우 설계 (사용자 경험 기준)

이리사 종합 분석기는 교사가 **분석 구조를 고민하지 않도록** 설계된다.  
교사는 최소한의 선택만 하고, 시스템이 나머지를 처리한다.

---

### 전체 입력 플로우 개요

```text
[시작]
  ↓
[분석 대상 선택]
  ├─ 학생 1명 분석
  └─ 학생 여러 명 분석
  ↓
[학생 기본 정보 입력]
  - 이름 또는 순번
  - 학교급 / 학년
  ↓
[자료 업로드]
  - 파일 형식 무관
  - 개수 제한 없음
  ↓
[시스템 자동 처리]
  - 파일 분해 (페이지/구간/표/영상/이미지 등등)
  - 학생 후보 자동 감지
  ↓
[자료–학생 매핑 확인]
  - 교사는 확인/수정만 수행
  ↓
[기준 선택 (선택 사항)]
  - 학교/교사 루브릭 또는 줄글, 정책 문서, 혼합형 등등
  ↓
[분석 생성]

## 기준 문서(Standard Reference) 설계

### 기준 문서란 무엇인가

이 시스템에서 말하는 기준 문서(Standard Reference)는  
단순한 서술형 채점 루브릭을 의미하지 않는다.

기준 문서란:

> **AI가 학생 데이터를 해석하고 문장을 생성할 때  
> 반드시 참고해야 하는 ‘해석·서술의 규칙 문서’ 전체를 의미한다.**

포함되는 예시는 다음과 같다.

- 서술형 평가 루브릭
- SEL 검사 결과 해석 가이드 (교사용)
- 학습심리·정서 검사 해석 문서
- 생활기록부 기재요령(교육부 지침)
- 학교·교사 내부 합의 기준 문서
- 특정 학교/과목에서만 사용하는 줄글 기준표

---

### 기준 문서의 공통 특징

기준 문서는 다음과 같은 성격을 가진다.

- 학생 데이터가 아님
- 분석 대상이 아님
- 점수 계산용이 아님

👉 **‘참조 기준(Knowledge)’으로만 사용된다.**

---

## 기준 문서 유형 분류 (형태에 따른 분기 없음)

기준 문서는 형태에 따라 분기하지 않는다.

| 문서 형태 | 예시 |
|---|---|
| 표(Table) | 서술형 평가 루브릭 |
| 줄글(Text) | SEL 해석 가이드 |
| 정책 문서 | 생활기록부 기재요령 |
| 혼합형 | 검사 결과 + 해석 문장 |

👉 시스템은 **형태가 아니라 ‘역할’만 인식**한다.

---

## 기준 문서 저장 구조 (DB 개념)

기준 문서는 파일이 아니라 **지식 객체**로 저장된다.

```text
StandardReference
- reference_id
- reference_name
- reference_scope
  - SYSTEM (시스템 기본)
  - SCHOOL (학교 공통)
  - TEACHER (교사 개인)
- reference_purpose
  - ANALYSIS_GUIDE (해석 기준)
  - WRITING_GUIDE (서술 규칙)
  - POLICY (정책/지침)
- reference_content (정제된 텍스트)
- source_file_id (선택)
- active_flag
- created_at
